<!--
MIT License

Copyright (c) 2026 Decentralized Science Labs

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
<link rel="preconnect" href="https://genesisl1.com" crossorigin />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<meta name="description" content="View an on-chain AI model NFT, inspect features and terms, and run local or on-chain inference via read calls or transactions." />
<meta name="keywords" content="model details, AI inference, on-chain inference, model NFT, GenesisL1, DeSci, EIP-712, paid inference" />
<meta name="author" content="Decentralized Science Labs" />
<meta name="robots" content="index,follow" />
<meta name="theme-color" content="#0f172a" />

<meta property="og:title" content="GenesisL1 Forest ‚Äî Model Details & Inference" />
<meta property="og:description" content="View an on-chain AI model NFT, inspect features and terms, and run local or on-chain inference via read calls or transactions." />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="GenesisL1 Forest" />
<meta property="og:image" content="https://genesisl1.com/logo.svg" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="GenesisL1 Forest ‚Äî Model Details & Inference" />
<meta name="twitter:description" content="View an on-chain AI model NFT, inspect features and terms, and run local or on-chain inference via read calls or transactions." />
<meta name="twitter:image" content="https://genesisl1.com/logo.svg" />
<title>GenesisL1 Forest ‚Äî Model Details & Inference</title>
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="./style.css" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.12.1/dist/ethers.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="brand">
        <a class="brand" href="./index.html" style="text-decoration:none;">
       <img src="https://genesisl1.com/logo.svg" alt="GenesisL1" style="width:28px; height:28px;" /> GenesisL1 Forest </a>
      </div>
      <button class="btn navToggle" type="button" aria-label="Menu" aria-controls="siteNav" aria-expanded="false"><span class="navToggleIcon" aria-hidden="true"></span></button>
      <div class="nav" id="siteNav" aria-label="Primary navigation">
        <a class="btn ghost" data-nav="forest" href="./forest.html">AI Models</a>
        <a class="btn ghost" data-nav="market" href="./aistore.html">AI Store</a>
        <a class="btn ghost" data-nav="create" href="./create.html">Create</a>
        <a class="btn ghost" data-nav="my" href="./my.html">My Models</a>
        <a class="btn ghost" data-nav="terms" href="./terms.html">Terms</a>
        <span class="pill" id="walletPill">Read-only (RPC)</span>
        <button class="btn primary" id="connectBtn">Connect Wallet</button>
      </div>
    </div>

    <div class="hero" id="hero">
      <h1 id="title">Model</h1>
      <p class="muted" id="desc">Loading‚Ä¶</p>
      <div class="row" style="flex-wrap: wrap;">
        <span class="pill" id="tokenPill">NFT ID: ‚Äî</span>
        <span class="pill" id="modePill">Inference: ‚Äî</span>
        <span class="pill" id="salePill">Sale: ‚Äî</span>
      </div>
    </div>

    <div class="grid2">
      <div class="panel">
        <h2>Model details</h2>
        <div class="row" style="justify-content:center; margin-bottom:16px;">
          <img id="icon" alt="Model icon" style="width: 128px; height: 128px; border-radius: 18px; border: 1px solid var(--border-light); background: white; object-fit: cover;" />
        </div>

        <div class="kv" id="kv"></div>

        <div class="sep"></div>

        <div class="muted">
          Creator: <a class="mono" id="creatorLink" href="./forest.html" style="text-decoration: none;">‚Äî</a><br/>
          Owner: <a class="mono" id="ownerAddrLink" href="./forest.html" style="text-decoration: none;">‚Äî</a>
        </div>

        <div class="sep"></div>

        <h3>Feature labels (on-chain)</h3>
        <div class="muted" id="featNote">Loading‚Ä¶</div>
        <div id="featList" class="muted" style="margin-top: 10px; line-height: 1.8;"></div>

        <div class="sep"></div>

        <div class="row">
          <button class="btn" id="refreshBtn">Refresh</button>
          <a class="btn" id="ownerLink" href="./forest.html">View owner‚Äôs models</a>
        </div>
      </div>

      <div class="panel">
        <h2>Inference</h2>
        <p class="muted">
          Default inference is a <b>free read call</b> (<span class="mono">eth_call</span>).
          If the model is configured as <b>Paid required</b> or <b>Tips</b>, you can optionally run a <b>transaction</b>.
        </p>

        <h3>Inputs</h3>
        <div class="featGrid" id="inferGrid"></div>

        <div class="sep"></div>

        <div class="row" style="flex-wrap: wrap;">
          <button class="btn primary" id="callBtn">Run (read call)</button>

          <div id="txBox" style="display:none; flex: 1; min-width: 260px;">
            <label>Tip / Payment (L1)</label>
            <input type="number" step="0.001" id="payAmt" value="0.001" />
            <div class="muted" id="payHint"></div>
          </div>

          <button class="btn" id="txBtn" style="display:none;">Run (transaction)</button>
        </div>

        <div class="sep"></div>

        <h3>Result</h3>
        <div class="kv" id="inferKV"></div>
      </div>
    </div>

    <div class="section" id="accessPanel" style="display:none">
      <h2>API Access Keys</h2>
      <div class="muted">
        For <b>Paid-required</b> models, the owner can sell time-limited API access keys.
        Buyers pay once, then can run inference via RPC (no MetaMask) using EIP-712 signed calls.
      </div>

      <div class="sep"></div>

      <div id="accessPlansList" class="cards"></div>

      <div class="sep"></div>

      <div id="buyAccessBox">
        <h3>Buy access</h3>
        <div class="row" style="align-items:flex-end;">
          <div style="flex:1">
            <label>Plan</label>
            <select id="planSelect"></select>
          </div>
          <div style="flex:1">
            <label>API key address</label>
            <input id="buyerKeyAddr" placeholder="0x‚Ä¶" />
          </div>
          <button id="genBuyerKeyBtn" class="btn small">Generate key</button>
        </div>

        <div class="row" style="align-items:flex-end; margin-top:12px;">
          <div style="flex:1">
            <label>Private key (save it)</label>
            <input id="buyerKeyPriv" type="password" placeholder="0x‚Ä¶" />
          </div>
          <button id="copyBuyerKeyBtn" class="btn small">Copy</button>
          <button id="buyPlanBtn" class="btn primary">Buy</button>
        </div>

        <div class="muted" id="expiryInfo" style="margin-top:10px;"></div>
      </div>

      <div class="sep"></div>

      <div id="ownerPlansBox" style="display:none">
        <h3>Owner: create / update plans</h3>
        <div class="row" style="align-items:flex-end;">
          <div style="flex:1">
            <label>Duration (blocks)</label>
            <input id="planDuration" placeholder="e.g. 40320 (‚âà 7 days @ 15s blocks)" />
          </div>
          <div style="flex:1">
            <label>Price (L1)</label>
            <input id="planPrice" placeholder="e.g. 10" />
          </div>
          <div style="flex:0.6">
            <label>Active</label>
            <select id="planActive">
              <option value="1">Yes</option>
              <option value="0">No</option>
            </select>
          </div>
          <button id="createPlanBtn" class="btn">Create plan</button>
        </div>

        <div class="row" style="align-items:flex-end; margin-top:12px;">
          <div style="flex:0.6">
            <label>Plan ID</label>
            <input id="editPlanId" placeholder="1" />
          </div>
          <div style="flex:1">
            <label>New duration (blocks)</label>
            <input id="editPlanDuration" placeholder="40320" />
          </div>
          <div style="flex:1">
            <label>New price (L1)</label>
            <input id="editPlanPrice" placeholder="10" />
          </div>
          <div style="flex:0.6">
            <label>Active</label>
            <select id="editPlanActive">
              <option value="1">Yes</option>
              <option value="0">No</option>
            </select>
          </div>
          <button id="setPlanBtn" class="btn">Update plan</button>
        </div>

        <div class="sep"></div>

        <h3>Owner: perpetual key</h3>
        <div class="row" style="align-items:flex-end;">
          <div style="flex:1">
            <label>Key address</label>
            <input id="ownerSetKeyAddr" placeholder="0x‚Ä¶" />
          </div>
          <button id="setOwnerKeyBtn" class="btn">Grant perpetual access</button>
          <button id="genOwnerKey2Btn" class="btn small">Generate new key</button>
        </div>
        <div class="row" style="align-items:flex-end; margin-top:12px;">
          <div style="flex:1">
            <label>Generated private key (save it)</label>
            <input id="ownerKey2Priv" type="password" placeholder="0x‚Ä¶" />
          </div>
          <button id="copyOwnerKey2Btn" class="btn small">Copy</button>
        </div>
      </div>

      <div class="sep"></div>

      <div id="keyInferBox">
        <h3>Inference via API key (no wallet)</h3>
        <div class="muted">
          Enter an API key private key that has valid access, then run <b>read-only</b> inference via RPC.
        </div>
        <div class="row" style="align-items:flex-end; margin-top:12px;">
          <div style="flex:1">
            <label>API key private key</label>
            <input id="keyPriv" type="password" placeholder="0x‚Ä¶" />
          </div>
          <button id="keyCallBtn" class="btn primary">Predict via key</button>
        </div>
      </div>
    </div>


    <div class="section">
      <h2>AI Store</h2>
      <div class="grid2">
        <div class="panel">
          <h3>Listing</h3>
          <div class="kv" id="marketKV"></div>

          <div class="sep"></div>

          <div id="ownerMarketBox" style="display:none;">
            <label>List price (L1)</label>
            <input id="listPrice" type="number" step="0.001" value="1" />
            <div class="row" style="margin-top: 12px;">
              <button class="btn primary" id="listBtn">List for sale</button>
              <button class="btn" id="cancelBtn">Cancel listing</button>
            </div>
            <div class="muted" style="margin-top: 10px;">Listing creates an on-chain sale offer. Buying transfers the NFT.</div>
          </div>

          <div id="buyBox" style="display:none;">
            <div class="row">
              <button class="btn primary" id="buyBtn">Buy now</button>
            </div>
            <div class="muted" style="margin-top: 10px;">Buying transfers ownership of the model NFT.</div>
          </div>
        </div>

        <div class="panel" id="ownerSettings" style="display:none;">
          <h3>Owner settings</h3>
          <p class="muted">Only the current NFT owner can change inference settings or burn & delete the model.</p>

          <div class="sep"></div>

          <label>Inference availability</label>
          <select id="enabledSel">
            <option value="1">Enabled</option>
            <option value="0">Disabled</option>
          </select>

          <label style="margin-top: 12px;">Inference mode</label>
          <select id="modeSel">
            <option value="0">Free</option>
            <option value="1">Tips (optional)</option>
            <option value="2">Paid required</option>
          </select>

          <label style="margin-top: 12px;">Inference fee (L1)</label>
          <input id="feeSel" type="number" step="0.001" value="0.001" />
          <div class="muted">UI clamps to 0.001‚Äì1 L1.</div>

          <label style="margin-top: 12px;">Fee recipient</label>
          <input id="recSel" placeholder="0x‚Ä¶ (defaults to you)" />

          <div class="row" style="margin-top: 14px;">
            <button class="btn primary" id="saveSettingsBtn">Save settings</button>
          </div>

          <div class="sep"></div>

          <h3>Burn & delete</h3>
          <p class="muted">
            This permanently burns the NFT and deletes the model metadata from the registry.
            Chunk code remains on-chain (EVM limitation), but the model is removed from the registry index.
          </p>
          <button class="btn danger" id="burnBtn">Burn & delete model</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Debug dock -->
  <div id="debugDock" class="debug-dock">
    <div class="debug-head">
      <div class="left">
        <span class="debug-badge">Debug</span>
        <span id="dbgState">idle</span>
        <span id="dbgConn" class="debug-badge" style="font-weight:650;">not connected</span>
      </div>
      <div class="right" style="display:flex; gap:6px; flex-wrap:wrap;">
        <button id="dbgCollapse" class="dbg-btn" type="button">Collapse</button>
        <button id="dbgCopy" class="dbg-btn" type="button">Copy</button>
        <button id="dbgClear" class="dbg-btn" type="button">Clear</button>
      </div>
    </div>
    <pre id="debugLines" class="debug-lines"></pre>
  </div>
  <div id="debugFab" class="debug-fab" hidden title="Show debug">üêû</div>


  <script type="module" src="./src/model_page.js"></script>

  <script>
    (() => {
      const topbar = document.querySelector(".topbar");
      const toggle = document.querySelector(".navToggle");
      const nav = document.getElementById("siteNav");
      if (!topbar || !toggle || !nav) return;

      const setOpen = (open) => {
        topbar.classList.toggle("menu-open", open);
        toggle.setAttribute("aria-expanded", open ? "true" : "false");
      };

      toggle.addEventListener("click", (e) => {
        e.preventDefault();
        setOpen(!topbar.classList.contains("menu-open"));
      });

      // Close when a link is selected (best for mobile)
      nav.addEventListener("click", (e) => {
        if (e.target.closest("a")) setOpen(false);
      });

      // Close when clicking outside the topbar
      document.addEventListener("click", (e) => {
        if (!topbar.contains(e.target) && topbar.classList.contains("menu-open")) setOpen(false);
      });

      // Close on Escape
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") setOpen(false);
      });

      // Reset when returning to desktop
      window.addEventListener("resize", () => {
        if (window.innerWidth > 860) setOpen(false);
      });
    })();
  </script>

</body>
</html>
